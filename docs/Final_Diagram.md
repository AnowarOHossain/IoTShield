# IoTShield â€” Final Thesis Diagrams

**Project Title:** Privacy-Preserving Real-Time Home Automation Utilizing MQTT Protocol and Sensor Anomaly Detection with GenAI Integration

**Authors:** Anowar Hossain (ID: 221071051) & Shihab Sarker (ID: 202071004)
**Department:** CSE, Shanto-Mariam University of Creative Technology (SMUCT)
**Supervisor:** Tahsin Alam, Lecturer, Department of CSE & CSIT

---

## Figure 1 â€” High-Level System Architecture

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              IoTShield â€” Privacy-Preserving IoT Security System             â•‘
â•‘          Real-Time Monitoring Â· Local AI Â· Dual-Layer Privacy               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                          HARDWARE LAYER                                   â”‚
  â”‚                                                                           â”‚
  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚   â”‚                  ESP32 Smart Sensor Hub                          â”‚   â”‚
  â”‚   â”‚                                                                   â”‚   â”‚
  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
  â”‚   â”‚  â”‚  DHT11   â”‚ â”‚  MQ-2   â”‚ â”‚  Flame   â”‚ â”‚   LDR    â”‚          â”‚   â”‚
  â”‚   â”‚  â”‚ Temp/Hum â”‚ â”‚   Gas   â”‚ â”‚ Detector â”‚ â”‚  Light   â”‚          â”‚   â”‚
  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚   â”‚
  â”‚   â”‚  â”‚   PIR    â”‚ â”‚ Analog  â”‚  ESP32 Firmware v3.0               â”‚   â”‚
  â”‚   â”‚  â”‚  Motion  â”‚ â”‚  Input  â”‚  WiFi 802.11 b/g/n                 â”‚   â”‚
  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  MQTT Client (PubSubClient)       â”‚   â”‚
  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚ WiFi (TCP/IP Â· Port 1883)
                                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        MESSAGING LAYER                                    â”‚
  â”‚                                                                           â”‚
  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
  â”‚           â”‚       Mosquitto MQTT Broker              â”‚                   â”‚
  â”‚           â”‚   Host: 172.172.13.77  Port: 1883       â”‚                   â”‚
  â”‚           â”‚   Topic: iotshield/sensors/data          â”‚                   â”‚
  â”‚           â”‚   QoS: 1 Â· Pub/Sub Pattern               â”‚                   â”‚
  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚ TCP Subscribe
                                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        BACKEND PROCESSING LAYER                           â”‚
  â”‚                                                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  MQTT Listener   â”‚  â”‚  Privacy Engine  â”‚  â”‚   Ollama AI Detector    â”‚  â”‚
  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                          â”‚  â”‚
  â”‚  â”‚ IoTShieldMQTT    â”‚â†’ â”‚ Layer 1: Gauss   â”‚â†’ â”‚  llama3.2:1b (Local)   â”‚  â”‚
  â”‚  â”‚ Client.py        â”‚  â”‚ Layer 2: RSA-2048â”‚  â”‚  Anomaly Analysis       â”‚  â”‚
  â”‚  â”‚ Django Mgmt Cmd  â”‚  â”‚ Îµ = 0.5          â”‚  â”‚  Severity: 4 Tiers      â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                         â”‚                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                     Django Backend Framework                        â”‚  â”‚
  â”‚  â”‚  PORT: 8000 Â· REST API Â· JWT Auth Â· CSRF Â· Session Management      â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜
                                     â”‚                                  â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
           â”‚                                       â”‚        â”‚  Email Alerts    â”‚
           â–¼                                       â–¼        â”‚  Gmail SMTP      â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  Port: 587 (TLS) â”‚
  â”‚   SQLite DB      â”‚                  â”‚   Web Dashboard    â”‚â”‚  CRITICAL + HIGH â”‚
  â”‚  db.sqlite3      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   Chart.js         â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                  â”‚                  â”‚   Tailwind CSS     â”‚
  â”‚ â€¢ Device         â”‚                  â”‚   Real-time API    â”‚
  â”‚ â€¢ SensorData     â”‚                  â”‚   http://127.0.0.1 â”‚
  â”‚ â€¢ Alert          â”‚                  â”‚   :8000            â”‚
  â”‚ â€¢ ControlCommand â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚ â€¢ SystemLog      â”‚
  â”‚ â€¢ auth_user      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 2 â€” End-to-End Data Flow Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     End-to-End Sensor Data Pipeline                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  STEP 1 â”€ Sensor Data Collection (Every 2 Seconds)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚              ESP32 GPIO & ADC Reading                   â”‚
  â”‚                                                         â”‚
  â”‚  GPIO-4  â†’ DHT11   â†’ Temperature (Â°C), Humidity (%)   â”‚
  â”‚  GPIO-5  â†’ MQ-2    â†’ Gas Level (ppm)                   â”‚
  â”‚  GPIO-6  â†’ Flame   â†’ Flame Detected (0/1)              â”‚
  â”‚  GPIO-7  â†’ LDR     â†’ Light Level (lux)                 â”‚
  â”‚  GPIO-8  â†’ PIR     â†’ Motion Detected (0/1)             â”‚
  â”‚  ADC     â†’ Analog  â†’ Raw analog value                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 2 â”€ JSON Payload Construction
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  {                                                      â”‚
  â”‚    "device_id":   "ESP32_HARDWARE_001",                 â”‚
  â”‚    "device_name": "ESP32 Smart Sensor Hub",             â”‚
  â”‚    "device_type": "ESP32",                              â”‚
  â”‚    "sensor_type": "TEMPERATURE",                        â”‚
  â”‚    "value":       25.3,                                  â”‚
  â”‚    "unit":        "Â°C",                                  â”‚
  â”‚    "location":    "Demo Lab",                            â”‚
  â”‚    "timestamp":   "2026-01-08T10:30:45Z"                â”‚
  â”‚  }                                                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 3 â”€ MQTT Publish (WiFi â†’ Broker)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Topic:    iotshield/sensors/data                       â”‚
  â”‚  Protocol: MQTT v3.1 over TCP                           â”‚
  â”‚  Port:     1883                                         â”‚
  â”‚  QoS:      Level 1 (At-least-once delivery)             â”‚
  â”‚  Broker:   Mosquitto at 172.172.13.77                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 4 â”€ Backend Reception & Decryption
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  IoTShieldMQTTClient.on_message()                       â”‚
  â”‚  â€¢ Decode UTF-8 payload                                 â”‚
  â”‚  â€¢ Parse JSON â†’ Python dict                             â”‚
  â”‚  â€¢ rsa_encryption.decrypt_mqtt_payload(data)            â”‚
  â”‚  â€¢ Route to handle_sensor_data()                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 5 â”€ Dual-Layer Privacy Processing
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  PrivacyEngine.add_noise_to_sensor_data()               â”‚
  â”‚                                                         â”‚
  â”‚  Layer 1 â€” Differential Privacy (Gaussian Mechanism)    â”‚
  â”‚    Ïƒ = (sensitivity Ã— âˆš(2 Ã— ln(1.25/Î´))) / Îµ           â”‚
  â”‚    noise = Normal(Î¼=0, ÏƒÂ²)                              â”‚
  â”‚    noisy_value = original_value + noise                 â”‚
  â”‚    Îµ = 0.5, Î´ = 1Ã—10â»âµ                                 â”‚
  â”‚                                                         â”‚
  â”‚  Layer 2 â€” RSA-2048 Encryption (OAEP + SHA-256)         â”‚
  â”‚    ciphertext = RSA_Encrypt(noisy_value, public_key)    â”‚
  â”‚    Storage: Base64(ciphertext) â†’ SQLite                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 6 â”€ Database Storage (SQLite)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  SensorData.objects.create(                             â”‚
  â”‚    device        = device_obj,                          â”‚
  â”‚    sensor_type   = "TEMPERATURE",                       â”‚
  â”‚    value         = noisy_value,                         â”‚
  â”‚    unit          = "Â°C",                                â”‚
  â”‚    is_anomaly    = False,   â† updated after AI analysis â”‚
  â”‚    anomaly_score = None,    â† updated after AI analysis â”‚
  â”‚    timestamp     = now()                                â”‚
  â”‚  )                                                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 7 â”€ Ollama AI Anomaly Detection
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  OllamaAnomalyDetector.analyze(sensor_data)             â”‚
  â”‚                                                         â”‚
  â”‚  â€¢ Build structured prompt with sensor context          â”‚
  â”‚  â€¢ POST to http://localhost:11434/api/generate          â”‚
  â”‚  â€¢ Model: llama3.2:1b (local inference, no cloud)       â”‚
  â”‚  â€¢ Parse JSON response from LLM                         â”‚
  â”‚  â€¢ Fields: anomaly, explanation, severity, suggestion   â”‚
  â”‚                                                         â”‚
  â”‚  Normal Ranges Used for Prompt Context:                 â”‚
  â”‚    TEMPERATURE  : 18â€“28 Â°C normal                       â”‚
  â”‚    HUMIDITY     : 30â€“60 % normal                        â”‚
  â”‚    GAS          : 0â€“0.35 ppm normal                     â”‚
  â”‚    FLAME        : 0â€“0.15 normal                         â”‚
  â”‚    MOTION       : 0â€“0.40 normal                         â”‚
  â”‚    LIGHT        : 100â€“600 lux normal                    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 8 â”€ Alert Generation & Multi-Channel Notification
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  IF anomaly detected â†’ Alert.objects.create(...)        â”‚
  â”‚                                                         â”‚
  â”‚  Severity Routing:                                      â”‚
  â”‚    CRITICAL â†’ Email (SMTP) + Dashboard + DB Log         â”‚
  â”‚    HIGH     â†’ Email (SMTP) + Dashboard + DB Log         â”‚
  â”‚    MEDIUM   â†’ Dashboard + DB Log                        â”‚
  â”‚    LOW      â†’ DB Log only                               â”‚
  â”‚                                                         â”‚
  â”‚  Email: Gmail SMTP, Port 587, TLS, HTML template        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
  STEP 9 â”€ Dashboard Rendering (User Browser)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  User â†’ http://127.0.0.1:8000                          â”‚
  â”‚  Django Auth â†’ Session check â†’ Render template          â”‚
  â”‚  Chart.js graphs, Alert table, Device status            â”‚
  â”‚  API polling: /api/sensor-data/, /api/alerts/           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 3 â€” Network Topology Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         IoTShield Network Topology                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚   Internet   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ WAN
                                   â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚     WiFi Router      â”‚
                       â”‚   192.168.1.1 / 24   â”‚
                       â”‚   DHCP Â· NAT Â· FW    â”‚
                       â”‚   WPA2 / WPA3        â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ LAN               â”‚ (802.11 b/g/n)          â”‚ LAN
              â”‚ (Ethernet)        â”‚ WiFi 2.4 GHz            â”‚ (Optional)
              â–¼                   â–¼                          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   PC / Server      â”‚ â”‚  ESP32 Device  â”‚      â”‚  Mobile / Tablet  â”‚
   â”‚  192.168.1.100     â”‚ â”‚ 192.168.1.150  â”‚      â”‚  192.168.1.XXX   â”‚
   â”‚                   â”‚ â”‚  (DHCP)        â”‚      â”‚  (DHCP)           â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚                â”‚      â”‚  Dashboard Access  â”‚
   â”‚  â”‚  Mosquitto  â”‚  â”‚ â”‚ GPIO-4: DHT11  â”‚      â”‚  http://server:8000â”‚
   â”‚  â”‚  Port: 1883  â”‚â—„â”€â”¼â”€â”‚ GPIO-5: MQ-2  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ GPIO-6: Flame  â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ GPIO-7: LDR    â”‚
   â”‚  â”‚   Django    â”‚  â”‚ â”‚ GPIO-8: PIR    â”‚
   â”‚  â”‚  Port: 8000  â”‚  â”‚ â”‚                â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ PubSubClient   â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ ArduinoJson    â”‚
   â”‚  â”‚   Ollama    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚  â”‚ Port: 11434  â”‚  â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Protocol Stack:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Application Layer  â”‚  HTTP/HTTPS  â”‚  MQTT  â”‚  SMTP       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Transport Layer    â”‚  TCP (reliable, ordered delivery)    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Network Layer      â”‚  IPv4 (192.168.1.0/24)              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Data Link Layer    â”‚  WiFi 802.11 b/g/n (ESP32 â†” Router) â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Physical Layer     â”‚  2.4 GHz Radio Frequency            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Port Allocation:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Port    â”‚  Service                    â”‚  Protocol  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚   1883    â”‚  MQTT Broker (Mosquitto)    â”‚  TCP       â”‚
  â”‚   8000    â”‚  Django Web Server          â”‚  HTTP      â”‚
  â”‚  11434    â”‚  Ollama Local LLM API       â”‚  HTTP      â”‚
  â”‚    587    â”‚  Gmail SMTP (Email Alerts)  â”‚  TCP + TLS â”‚
  â”‚   8883    â”‚  MQTT-TLS (Future)          â”‚  TCP + TLS â”‚
  â”‚    443    â”‚  HTTPS (Production)         â”‚  TCP + TLS â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 4 â€” Database Entity-Relationship Diagram

```
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                 auth_user                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ PK  id          INTEGER                  â”‚
  â”‚     username    VARCHAR(150)             â”‚
  â”‚     password    VARCHAR(128)             â”‚
  â”‚     email       VARCHAR(254)             â”‚
  â”‚     is_active   BOOLEAN                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚  authenticates via session / JWT
                         â”‚  (Login required to access dashboard,
                         â”‚   manage devices and view alerts)
                         â”‚
                         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚            dashboard_device               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ PK  id           INTEGER                 â”‚
  â”‚     device_id    VARCHAR(100)  UNIQUE    â”‚
  â”‚     device_type  VARCHAR(20)             â”‚
  â”‚     name         VARCHAR(200)            â”‚
  â”‚     location     VARCHAR(200)            â”‚
  â”‚     is_active    BOOLEAN                 â”‚
  â”‚     last_seen    DATETIME                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚  Relationship: ONE device
                         â”‚  FK  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  MANY sensor readings
                         â”‚  (dashboard_sensordata.device_id
                         â”‚   â†’ dashboard_device.id)
                         â”‚
                         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚           dashboard_sensordata            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ PK  id            INTEGER                â”‚
  â”‚ FK  device_id     â†’ dashboard_device.id  â”‚  â—„â”€â”€ links to parent device
  â”‚     sensor_type   VARCHAR                â”‚
  â”‚       TEMPERATURE Â· HUMIDITY Â· GAS       â”‚
  â”‚       FLAME Â· MOTION Â· LIGHT             â”‚
  â”‚     value         FLOAT                  â”‚
  â”‚     unit          VARCHAR                â”‚
  â”‚     is_anomaly    BOOLEAN                â”‚
  â”‚     anomaly_score FLOAT                  â”‚
  â”‚     timestamp     DATETIME               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚  Relationship: ONE sensor reading
                         â”‚  FK  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  MANY alerts
                         â”‚  (dashboard_alert.sensor_data_id
                         â”‚   â†’ dashboard_sensordata.id)
                         â”‚
                         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚             dashboard_alert               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ PK  id             INTEGER               â”‚
  â”‚ FK  sensor_data_id â†’ dashboard_sensordataâ”‚  â—„â”€â”€ links to triggering reading
  â”‚     title          VARCHAR               â”‚
  â”‚     description    TEXT                  â”‚
  â”‚     ai_suggestion  TEXT                  â”‚
  â”‚     severity       VARCHAR               â”‚
  â”‚       LOW Â· MEDIUM Â· HIGH Â· CRITICAL     â”‚
  â”‚     status         VARCHAR               â”‚
  â”‚       NEW Â· ACKNOWLEDGED Â· RESOLVED      â”‚
  â”‚     created_at     DATETIME              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Connection Summary:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  auth_user         â”€â”€(session/JWT)â”€â”€â–º  dashboard_device             â”‚
  â”‚                                        (access control only)        â”‚
  â”‚                                                                     â”‚
  â”‚  dashboard_device  â”€â”€(1 : MANY)â”€â”€â”€â”€â”€â”€â–º dashboard_sensordata         â”‚
  â”‚    via  dashboard_sensordata.device_id â†’ dashboard_device.id        â”‚
  â”‚                                                                     â”‚
  â”‚  dashboard_sensordata â”€â”€(1 : MANY)â”€â”€â”€â–º dashboard_alert             â”‚
  â”‚    via  dashboard_alert.sensor_data_id â†’ dashboard_sensordata.id   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 5 â€” Dual-Layer Privacy Protection Architecture

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Dual-Layer Privacy: Differential Privacy + RSA Encryption      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  RAW SENSOR INPUT
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   ESP32 Sensor Reading       â”‚
  â”‚   Temperature = 25.0 Â°C      â”‚
  â”‚   Humidity    = 52.0 %       â”‚
  â”‚   Gas Level   = 0.28 ppm     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  LAYER 1: DIFFERENTIAL PRIVACY (Gaussian Mechanism)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                  â”‚
  â”‚  Privacy Parameters:                             â”‚
  â”‚    Îµ (Epsilon) = 0.5     â† Privacy Budget       â”‚
  â”‚    Î´ (Delta)   = 1Ã—10â»âµ  â† Failure Probability  â”‚
  â”‚                                                  â”‚
  â”‚  Noise Calculation (per sensor type):            â”‚
  â”‚    Ïƒ = (Î”f Ã— âˆš(2 Ã— ln(1.25/Î´))) / Îµ             â”‚
  â”‚                                                  â”‚
  â”‚  Sensor Sensitivities:                           â”‚
  â”‚    TEMPERATURE : Î”f = 2.0  Â°C                   â”‚
  â”‚    HUMIDITY    : Î”f = 5.0  %                    â”‚
  â”‚    GAS         : Î”f = 0.1  ppm                  â”‚
  â”‚    FLAME       : Î”f = 0.05                       â”‚
  â”‚    MOTION      : Î”f = 0.0  (binary, no noise)   â”‚
  â”‚    LIGHT       : Î”f = 10.0 lux                  â”‚
  â”‚                                                  â”‚
  â”‚  Gaussian Noise Addition:                        â”‚
  â”‚    noise = Random.Normal(mean=0, std=Ïƒ)          â”‚
  â”‚    noisy_value = original_value + noise          â”‚
  â”‚                                                  â”‚
  â”‚  Output: 25.0 + 0.523 = 25.523 Â°C  (noisy)     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  LAYER 2: RSA-2048 ENCRYPTION (OAEP + SHA-256)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                  â”‚
  â”‚  Algorithm  : RSA (Rivestâ€“Shamirâ€“Adleman)        â”‚
  â”‚  Key Size   : 2048 bits                          â”‚
  â”‚  Padding    : OAEP (Optimal Asymmetric Padding)  â”‚
  â”‚  Hash       : SHA-256                            â”‚
  â”‚  Library    : PyCryptodome (Crypto.Cipher)       â”‚
  â”‚                                                  â”‚
  â”‚  Key Management:                                 â”‚
  â”‚    Public Key  â†’ keys/public_key.pem  (encrypt)  â”‚
  â”‚    Private Key â†’ keys/private_key.pem (decrypt)  â”‚
  â”‚    Generator   â†’ manage_rsa_keys.py              â”‚
  â”‚                                                  â”‚
  â”‚  Encryption Process:                             â”‚
  â”‚    plaintext  = str(noisy_value).encode()        â”‚
  â”‚    cipher     = PKCS1_OAEP.new(public_key)       â”‚
  â”‚    ciphertext = cipher.encrypt(plaintext)        â”‚
  â”‚    encoded    = Base64(ciphertext)               â”‚
  â”‚                                                  â”‚
  â”‚  Output: "eyJlbmNyeXB0ZWQiOiAiYzJW..."          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚    ENCRYPTED STORAGE (SQLite Database)           â”‚
  â”‚                                                  â”‚
  â”‚    SensorData.value = 25.523  (noisy float)      â”‚
  â”‚    Encrypted blob   = Base64 RSA ciphertext      â”‚
  â”‚    Protection Level = Noise + RSA + DB           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Privacy Guarantee:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Mathematical Guarantee: Îµ-Î´ Differential Privacy                â”‚
  â”‚                                                                  â”‚
  â”‚  P[M(D)âˆˆS] â‰¤ exp(Îµ) Ã— P[M(D')âˆˆS] + Î´                          â”‚
  â”‚                                                                  â”‚
  â”‚  Meaning: Any attacker viewing collected sensor data              â”‚
  â”‚  cannot determine the exact original reading with               â”‚
  â”‚  probability greater than exp(0.5) â‰ˆ 1.65Ã—                     â”‚
  â”‚  the base probability. Accuracy loss: < 2%.                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 6 â€” Ollama AI Anomaly Detection Pipeline

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘             Ollama Local LLM Anomaly Detection Pipeline                     â•‘
â•‘                        Model: llama3.2:1b                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                      INPUT: Sensor Data Dict                        â”‚
  â”‚   { sensor_type, value, unit, device_name, location, timestamp }   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  STEP 1: Build Analysis Prompt                      â”‚
  â”‚                                                                     â”‚
  â”‚  _create_analysis_prompt() includes:                                â”‚
  â”‚  â€¢ Sensor type, current value, unit                                 â”‚
  â”‚  â€¢ Device name, location, timestamp                                 â”‚
  â”‚  â€¢ Normal range context for that sensor type                        â”‚
  â”‚  â€¢ Severity classification guidelines                               â”‚
  â”‚  â€¢ Examples of LOW / MEDIUM / HIGH / CRITICAL readings              â”‚
  â”‚  â€¢ Strict JSON output format requirement                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                STEP 2: Call Ollama REST API                         â”‚
  â”‚                                                                     â”‚
  â”‚  POST http://localhost:11434/api/generate                           â”‚
  â”‚  {                                                                  â”‚
  â”‚    "model":       "llama3.2:1b",                                   â”‚
  â”‚    "prompt":      <structured prompt>,                              â”‚
  â”‚    "stream":      false,                                            â”‚
  â”‚    "temperature": 0.7,                                              â”‚
  â”‚    "top_p":       0.9,                                              â”‚
  â”‚    "top_k":       40                                                â”‚
  â”‚  }                                                                  â”‚
  â”‚                                                                     â”‚
  â”‚  Timeout: 60 seconds Â· Runs fully LOCAL (no cloud dependency)      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                    STEP 3: Parse LLM Response                       â”‚
  â”‚                                                                     â”‚
  â”‚  LLM Output (JSON):                                                 â”‚
  â”‚  {                                                                  â”‚
  â”‚    "anomaly":     true,                                             â”‚
  â”‚    "explanation": "Temperature 52Â°C is 86% above the normal        â”‚
  â”‚                   ceiling of 28Â°C, indicating a heat hazard.",     â”‚
  â”‚    "severity":    "CRITICAL",                                       â”‚
  â”‚    "suggestion":  "Immediately check for fire or equipment          â”‚
  â”‚                   overheating. Activate cooling or evacuate."      â”‚
  â”‚  }                                                                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚             STEP 4: Severity-Based Routing                          â”‚
  â”‚                                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚CRITICAL  â”‚ >75Â°C Â· Active Flame Â· Gas >1000ppm               â”‚ â”‚
  â”‚  â”‚  ğŸ”´      â”‚ Action: Email Alert + Dashboard + DB Log           â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚HIGH      â”‚ 50â€“75Â°C Â· Moderate gas Â· Unusual motion            â”‚ â”‚
  â”‚  â”‚  ğŸŸ       â”‚ Action: Email Alert + Dashboard + DB Log           â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚MEDIUM    â”‚ 35â€“50Â°C Â· Gas 0.51â€“0.65ppm Â· LDR > 800 lux        â”‚ â”‚
  â”‚  â”‚  ğŸŸ¡      â”‚ Action: Dashboard + DB Log only                    â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚LOW       â”‚ 30â€“35Â°C Â· Minor deviations (5â€“15%)                 â”‚ â”‚
  â”‚  â”‚  ğŸŸ¢      â”‚ Action: DB Log only                                â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                                       â”‚
                  â–¼                                       â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Alert DB Record      â”‚               â”‚    Email Notification   â”‚
  â”‚                        â”‚               â”‚   (CRITICAL / HIGH)     â”‚
  â”‚  Alert.objects.create( â”‚               â”‚                         â”‚
  â”‚    sensor_data = ...,  â”‚               â”‚  Subject: CRITICAL Alert â”‚
  â”‚    title       = ...,  â”‚               â”‚  To: admin@example.com  â”‚
  â”‚    description = LLM   â”‚               â”‚  Via: Gmail SMTP        â”‚
  â”‚                  text, â”‚               â”‚  Port: 587 (TLS)        â”‚
  â”‚    severity    = ...,  â”‚               â”‚  Body: HTML template    â”‚
  â”‚    status      = "NEW" â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚  )                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Fallback Mechanism (if Ollama unavailable):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  _get_fallback_response() â†’ Rule-based thresholds                   â”‚
  â”‚  Uses hard-coded normal ranges per sensor type                      â”‚
  â”‚  Returns: anomaly=True/False, severity, generic explanation         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 7 â€” MQTT Communication Architecture

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       MQTT Topic & Message Architecture                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Topic Hierarchy:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  iotshield/                                                         â”‚
  â”‚  â”œâ”€â”€ sensors/                                                       â”‚
  â”‚  â”‚   â””â”€â”€ data          â† ESP32 publishes all sensor readings here   â”‚
  â”‚  â”œâ”€â”€ control/                                                       â”‚
  â”‚  â”‚   â””â”€â”€ commands      â† Backend sends control commands to devices  â”‚
  â”‚  â”œâ”€â”€ anomalies         â† Backend publishes detected anomalies       â”‚
  â”‚  â”œâ”€â”€ alerts            â† Backend publishes generated alerts         â”‚
  â”‚  â””â”€â”€ logs              â† Backend publishes system log events        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Publisher â€” Subscriber Architecture:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                                     â”‚
  â”‚   ESP32 Firmware                     Django Backend                â”‚
  â”‚   (PubSubClient)                     (paho-mqtt)                   â”‚
  â”‚                                                                     â”‚
  â”‚   PUBLISH:                           SUBSCRIBE:                    â”‚
  â”‚   iotshield/sensors/data  â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º iotshield/sensors/data       â”‚
  â”‚                                                                     â”‚
  â”‚   SUBSCRIBE:                         PUBLISH:                      â”‚
  â”‚   iotshield/control/commands â—„â”€â”€â”€â”€â”€â”€  iotshield/control/commands   â”‚
  â”‚                                      iotshield/anomalies           â”‚
  â”‚                                      iotshield/alerts              â”‚
  â”‚                                      iotshield/logs                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  MQTT Message Format (iotshield/sensors/data):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  {                                                                  â”‚
  â”‚    "device_id":   "ESP32_HARDWARE_001",                            â”‚
  â”‚    "device_name": "ESP32 Smart Sensor Hub",                        â”‚
  â”‚    "device_type": "ESP32",                                         â”‚
  â”‚    "sensor_type": "TEMPERATURE",     â† One reading per message     â”‚
  â”‚    "value":       25.3,                                            â”‚
  â”‚    "unit":        "Â°C",                                            â”‚
  â”‚    "location":    "Demo Lab",                                      â”‚
  â”‚    "timestamp":   "2026-01-08T10:30:45Z"                          â”‚
  â”‚  }                                                                  â”‚
  â”‚                                                                     â”‚
  â”‚  Size: ~250 bytes/message   Rate: 6 sensors Ã— 1/2s = 3 msg/sec   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  MQTT Connection Settings:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Broker      : Mosquitto (open-source)                             â”‚
  â”‚  Host        : 172.172.13.77  (University LAN IP)                 â”‚
  â”‚  Port        : 1883                                                â”‚
  â”‚  Protocol    : MQTT v3.1                                           â”‚
  â”‚  QoS Level   : 1 (At-least-once delivery)                         â”‚
  â”‚  Keep-Alive  : 60 seconds                                          â”‚
  â”‚  Client IDs  : ESP32_HARDWARE_001 (device)                        â”‚
  â”‚                iotshield_backend (Django)                          â”‚
  â”‚  Auto-Retry  : 5 seconds on disconnect                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 8 â€” Multi-Layer Security Architecture

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     IoTShield Multi-Layer Security Model                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  LAYER 5 â€” Data Encryption & Integrity                              â”‚
  â”‚                                                                     â”‚
  â”‚  â€¢ Algorithm     : RSA-2048 (Rivestâ€“Shamirâ€“Adleman)                â”‚
  â”‚  â€¢ Padding       : OAEP (Optimal Asymmetric Encryption Padding)    â”‚
  â”‚  â€¢ Hash Function : SHA-256                                          â”‚
  â”‚  â€¢ Key Store     : keys/public_key.pem Â· keys/private_key.pem     â”‚
  â”‚  â€¢ Storage Format: Base64 encoded ciphertext in SQLite             â”‚
  â”‚  â€¢ Key Manager   : manage_rsa_keys.py (CLI tool)                   â”‚
  â”‚  â€¢ Status        : âœ… ACTIVE                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â–²
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  LAYER 4 â€” Privacy Preservation (Differential Privacy)              â”‚
  â”‚                                                                     â”‚
  â”‚  â€¢ Model         : Îµ-Î´ Differential Privacy                         â”‚
  â”‚  â€¢ Mechanism     : Gaussian Noise Injection                         â”‚
  â”‚  â€¢ Îµ (Epsilon)   : 0.5  (configurable via .env)                    â”‚
  â”‚  â€¢ Î´ (Delta)     : 1Ã—10â»âµ                                          â”‚
  â”‚  â€¢ Implementation: PrivacyEngine.add_noise_to_sensor_data()        â”‚
  â”‚  â€¢ Accuracy Loss : < 2% statistical deviation                      â”‚
  â”‚  â€¢ Status        : âœ… ACTIVE                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â–²
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  LAYER 3 â€” Application Security                                     â”‚
  â”‚                                                                     â”‚
  â”‚  â€¢ User Auth     : Django built-in authentication                   â”‚
  â”‚  â€¢ Token Auth    : JWT (rest_framework_simplejwt)                   â”‚
  â”‚    - Access token  : 1 hour lifetime                                â”‚
  â”‚    - Refresh token : 7 days lifetime                                â”‚
  â”‚  â€¢ Session Mgmt  : Django session middleware                        â”‚
  â”‚  â€¢ CSRF          : CsrfViewMiddleware (all state-changing views)    â”‚
  â”‚  â€¢ Input Valid.  : JSON schema + Django ORM sanitization            â”‚
  â”‚  â€¢ Security MW   : SecurityMiddleware (HSTS, nosniff, etc.)        â”‚
  â”‚  â€¢ Status        : âœ… ACTIVE                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â–²
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  LAYER 2 â€” Message Protocol Security                                â”‚
  â”‚                                                                     â”‚
  â”‚  â€¢ Protocol      : MQTT v3.1                                        â”‚
  â”‚  â€¢ QoS           : Level 1 (at-least-once, with ACK)               â”‚
  â”‚  â€¢ Payload Valid.: JSON schema validation on receipt                â”‚
  â”‚  â€¢ Topic Control : Structured topic hierarchy                       â”‚
  â”‚  â€¢ Encryption    : RSA payload encryption before publish            â”‚
  â”‚  â€¢ Status        : âœ… ACTIVE (TLS planned for production)           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â–²
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  LAYER 1 â€” Network & Hardware Security                              â”‚
  â”‚                                                                     â”‚
  â”‚  â€¢ WiFi Std      : 802.11 b/g/n (2.4 GHz)                         â”‚
  â”‚  â€¢ WiFi Encrypt  : WPA2 / WPA3 (CCMP/AES)                         â”‚
  â”‚  â€¢ Network Scope : Private LAN (192.168.1.0/24)                   â”‚
  â”‚  â€¢ Firewall      : Router-level port filtering                     â”‚
  â”‚  â€¢ ESP32 FW      : Firmware v3.0 â€” no remote code execution       â”‚
  â”‚  â€¢ Status        : âœ… ACTIVE                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 9 â€” ESP32 Firmware & Sensor Integration Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  ESP32 Hardware & Sensor Integration                        â•‘
â•‘                    Firmware Version: 3.0 (Production)                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ESP32-S3 Microcontroller
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                                     â”‚
  â”‚  GPIO PIN MAP:                  SENSOR CONNECTION:                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚  GPIO-2   â”‚  LED     â”‚     â”‚  Status LED (onboard)          â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚  GPIO-4   â”‚  DHT11   â”‚â”€â”€â”€â”€â–ºâ”‚  Temperature & Humidity Sensor  â”‚ â”‚
  â”‚  â”‚           â”‚ (DATA)   â”‚     â”‚  Digital One-Wire Protocol      â”‚ â”‚
  â”‚  â”‚           â”‚          â”‚     â”‚  Range: -20Â°C to +60Â°C          â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚  GPIO-5   â”‚  MQ-2    â”‚â”€â”€â”€â”€â–ºâ”‚  Gas Sensor (LPG, CHâ‚„, Smoke)  â”‚ â”‚
  â”‚  â”‚           â”‚ (ADC)    â”‚     â”‚  Analog Output â†’ ADC Read       â”‚ â”‚
  â”‚  â”‚           â”‚          â”‚     â”‚  Range: 0â€“10,000 ppm            â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚  GPIO-6   â”‚  FLAME   â”‚â”€â”€â”€â”€â–ºâ”‚  Flame / IR Detector           â”‚ â”‚
  â”‚  â”‚           â”‚ (ADC)    â”‚     â”‚  Analog Output â†’ ADC Read       â”‚ â”‚
  â”‚  â”‚           â”‚          â”‚     â”‚  Binary: Flame / No Flame       â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚  GPIO-7   â”‚  LDR     â”‚â”€â”€â”€â”€â–ºâ”‚  Light Dependent Resistor      â”‚ â”‚
  â”‚  â”‚           â”‚ (ADC)    â”‚     â”‚  Analog â†’ lux conversion        â”‚ â”‚
  â”‚  â”‚           â”‚          â”‚     â”‚  Range: 0â€“1000+ lux             â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚  GPIO-8   â”‚  PIR     â”‚â”€â”€â”€â”€â–ºâ”‚  Passive Infrared Motion Sensorâ”‚ â”‚
  â”‚  â”‚           â”‚ (INPUT)  â”‚     â”‚  Digital HIGH / LOW             â”‚ â”‚
  â”‚  â”‚           â”‚          â”‚     â”‚  Detection range: ~5 meters     â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                                                                     â”‚
  â”‚  Software Libraries:                                               â”‚
  â”‚    WiFi.h         â†’ ESP32 WiFi module management                   â”‚
  â”‚    PubSubClient.h â†’ MQTT client (Publisher / Subscriber)           â”‚
  â”‚    ArduinoJson.h  â†’ JSON serialization for MQTT payloads           â”‚
  â”‚    DHT.h          â†’ DHT11 sensor reading library                   â”‚
  â”‚                                                                     â”‚
  â”‚  Firmware Behaviour:                                               â”‚
  â”‚    1. Initialize GPIO / DHT11 on boot                              â”‚
  â”‚    2. Auto-detect if real sensors fail â†’ switch to simulator mode  â”‚
  â”‚    3. Connect to WiFi (SSID: SMUCT, timeout: 20s)                 â”‚
  â”‚    4. Connect to MQTT broker (retry every 5s on fail)              â”‚
  â”‚    5. Every 2 seconds: read 6 sensors â†’ format JSON â†’ publish      â”‚
  â”‚    6. Software clock for timestamps (no RTC module required)       â”‚
  â”‚    7. LED blink on each successful publish                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Auto-Fallback Simulator Mode:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  If DHT11 fails on startup â†’ USE_SIMULATOR = true                  â”‚
  â”‚                                                                     â”‚
  â”‚  Simulated Patterns (Realistic Waveforms):                         â”‚
  â”‚    Temperature : Sine wave oscillation 20Â°Câ€“30Â°C                  â”‚
  â”‚    Humidity    : Counter-phase to temperature (50%â€“70%)            â”‚
  â”‚    Gas         : Random Â± 0.05 around baseline                     â”‚
  â”‚    Flame       : Mostly 0.0, occasional spike to 0.6+              â”‚
  â”‚    Motion      : Random 0.0â€“0.8 (activity simulation)             â”‚
  â”‚    Light       : Day cycle pattern (low at night, high at noon)   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 10 â€” System Sequence Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘               System Interaction Sequence Diagram                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ESP32        WiFi/LAN       MQTT Broker    Django Backend    Ollama LLM    Email / Browser
  â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚ Read sensors  â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚          â”‚    â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚ JSON payload  â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚ MQTT PUBLISH  â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  topic:       â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  iotshield/   â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  sensors/data â”‚ on_message()  â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ Parse JSON    â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ RSA Decrypt   â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ Add Gaussian  â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ Noise (DP)    â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ RSA Encrypt   â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ + DB Store    â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ POST /generateâ”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚ LLM Analysis  â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
    â”‚               â”‚               â”‚               â”‚ JSON response â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ anomaly=True? â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ severity=CRITICAL/HIGH?       â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚               â”‚               â”‚               â”‚               â”‚  Email sent   â”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚ Dashboard API request         â”‚
    â”‚               â”‚               â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚               â”‚               â”‚               â”‚ Return HTML / JSON            â”‚
    â”‚               â”‚               â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚               â”‚               â”‚               â”‚               â”‚               â”‚
```

---

## Figure 11 â€” Alert Classification & Notification Flow

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                 Alert Severity Classification & Notification Flow           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Anomaly Event Detected
          â”‚
          â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚               Severity Classification Engine                      â”‚
  â”‚               (Ollama LLM + Rule-based fallback)                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                        â”‚
    â–¼                                        â–¼
  HIGH / CRITICAL                       MEDIUM / LOW
  Threshold Exceeded                   Minor Deviation
          â”‚                                  â”‚
          â–¼                                  â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   CRITICAL ğŸ”´      â”‚            â”‚    MEDIUM ğŸŸ¡        â”‚
  â”‚                    â”‚            â”‚                    â”‚
  â”‚ Examples:          â”‚            â”‚ Examples:          â”‚
  â”‚  Temp > 75Â°C       â”‚            â”‚  Temp 35â€“50Â°C      â”‚
  â”‚  Gas  > 1000 ppm   â”‚            â”‚  Gas 0.51â€“0.65ppm  â”‚
  â”‚  Flame detected    â”‚            â”‚  Light >800 lux    â”‚
  â”‚  (value > 0.71)    â”‚            â”‚                    â”‚
  â”‚                    â”‚            â”‚ Actions:           â”‚
  â”‚ Actions:           â”‚            â”‚  â€¢ DB log entry    â”‚
  â”‚  â€¢ DB log entry    â”‚            â”‚  â€¢ Dashboard alert â”‚
  â”‚  â€¢ Dashboard alert â”‚            â”‚    banner shown    â”‚
  â”‚  â€¢ Email to admin  â”‚            â”‚  â€¢ No email sent   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚    HIGH ğŸŸ           â”‚            â”‚     LOW ğŸŸ¢          â”‚
  â”‚                    â”‚            â”‚                    â”‚
  â”‚ Examples:          â”‚            â”‚ Examples:          â”‚
  â”‚  Temp 50â€“75Â°C      â”‚            â”‚  Temp 30â€“35Â°C      â”‚
  â”‚  Gas 0.66â€“0.75ppm  â”‚            â”‚  Humidity 60â€“70%   â”‚
  â”‚  Humidity > 90%    â”‚            â”‚  Minor deviations  â”‚
  â”‚                    â”‚            â”‚  (5â€“15% from norm) â”‚
  â”‚ Actions:           â”‚            â”‚                    â”‚
  â”‚  â€¢ DB log entry    â”‚            â”‚ Actions:           â”‚
  â”‚  â€¢ Dashboard alert â”‚            â”‚  â€¢ DB log only     â”‚
  â”‚  â€¢ Email to admin  â”‚            â”‚  â€¢ No dashboard    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚    alert shown     â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Alert Lifecycle (Status State Machine):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                             â”‚
  â”‚       NEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º ACKNOWLEDGED â”€â”€â”€â”€â”€â”€â”€â”€â–º RESOLVED    â”‚
  â”‚        â”‚                                                    â”‚
  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º IGNORED      â”‚
  â”‚                                                             â”‚
  â”‚  NEW          : Alert just created by AI detection         â”‚
  â”‚  ACKNOWLEDGED : Admin has seen the alert                   â”‚
  â”‚  RESOLVED     : Situation confirmed resolved               â”‚
  â”‚  IGNORED      : False positive, dismissed by admin         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Alert Distribution Statistics (60+ hours of operation):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ”´ CRITICAL : ~8%  ( ~12 alerts) â€” Email + Dashboard      â”‚
  â”‚  ğŸŸ  HIGH     : ~18% ( ~27 alerts) â€” Email + Dashboard      â”‚
  â”‚  ğŸŸ¡ MEDIUM   : ~35% ( ~52 alerts) â€” Dashboard only         â”‚
  â”‚  ğŸŸ¢ LOW      : ~39% ( ~59 alerts) â€” DB Log only            â”‚
  â”‚                                                            â”‚
  â”‚  Total: 150+ alerts Â· False Positive Rate: <0.5%           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 12 â€” Software Component Architecture

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  IoTShield Software Component Architecture                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  iotshield_backend/                    dashboard/
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  settings.py               â”‚        â”‚  models.py                  â”‚
  â”‚  â€¢ DB, MQTT, Ollama config â”‚        â”‚  â€¢ Device                   â”‚
  â”‚  â€¢ Privacy Îµ, Î´ params     â”‚        â”‚  â€¢ SensorData               â”‚
  â”‚  â€¢ Email SMTP settings     â”‚        â”‚  â€¢ Alert                    â”‚
  â”‚  â€¢ JWT token lifetime      â”‚        â”‚  â€¢ ControlCommand           â”‚
  â”‚  â€¢ RSA key settings        â”‚        â”‚  â€¢ SystemLog                â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  mqtt_client.py            â”‚        â”‚  views.py                   â”‚
  â”‚  â€¢ IoTShieldMQTTClient     â”‚        â”‚  â€¢ dashboard()              â”‚
  â”‚  â€¢ on_connect / on_message â”‚        â”‚  â€¢ devices()                â”‚
  â”‚  â€¢ handle_sensor_data()    â”‚        â”‚  â€¢ alerts()                 â”‚
  â”‚  â€¢ handle_control_cmd()    â”‚        â”‚  â€¢ api_sensor_data()        â”‚
  â”‚  â€¢ Singleton MQTT instance â”‚        â”‚  â€¢ api_alerts()             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚  â€¢ login_view()             â”‚
  â”‚  ollama_anomaly_detector.pyâ”‚        â”‚  â€¢ register_view()          â”‚
  â”‚  â€¢ OllamaAnomalyDetector   â”‚        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â€¢ analyze(sensor_data)    â”‚        â”‚  urls.py                    â”‚
  â”‚  â€¢ _create_analysis_prompt â”‚        â”‚  â€¢ URL routing              â”‚
  â”‚  â€¢ _call_ollama_api()      â”‚        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â€¢ _parse_ollama_response()â”‚        â”‚  templates/                 â”‚
  â”‚  â€¢ _get_fallback_response()â”‚        â”‚  â€¢ dashboard.html           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚  â€¢ devices.html             â”‚
  â”‚  privacy_engine.py         â”‚        â”‚  â€¢ alerts.html              â”‚
  â”‚  â€¢ PrivacyEngine           â”‚        â”‚  â€¢ login.html               â”‚
  â”‚  â€¢ add_gaussian_noise()    â”‚        â”‚  â€¢ register.html            â”‚
  â”‚  â€¢ add_laplace_noise()     â”‚        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â€¢ add_noise_to_sensor_dataâ”‚        â”‚  static/                    â”‚
  â”‚  â€¢ RSA encrypt / decrypt   â”‚        â”‚  â€¢ css/ (Tailwind CSS)      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚  â€¢ js/ (Chart.js + custom)  â”‚
  â”‚  utils/                    â”‚        â”‚  â€¢ images/                  â”‚
  â”‚  â”œâ”€â”€ email_alerts.py       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚  â”‚   â€¢ send_alert_email()  â”‚
  â”‚  â”‚   â€¢ HTML email builder  â”‚
  â”‚  â”œâ”€â”€ mqtt_utils.py         â”‚
  â”‚  â”œâ”€â”€ noise_utils.py        â”‚
  â”‚  â”œâ”€â”€ db_helpers.py         â”‚
  â”‚  â””â”€â”€ logger.py             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  auth_views.py             â”‚
  â”‚  â€¢ Login / Logout / Registerâ”‚
  â”‚  â€¢ JWT token endpoints     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  management/commands/
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  mqtt_listener.py           â”‚
  â”‚  â€¢ Django management commandâ”‚
  â”‚  â€¢ python manage.py         â”‚
  â”‚    mqtt_listener            â”‚
  â”‚  â€¢ Starts IoTShieldMQTT     â”‚
  â”‚    Client as background     â”‚
  â”‚    service                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  External Services:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Mosquitto MQTT Broker  â”‚  Ollama REST API  â”‚  Gmail SMTP     â”‚
  â”‚  Port: 1883             â”‚  Port: 11434      â”‚  Port: 587/TLS  â”‚
  â”‚  Local process          â”‚  Local process    â”‚  Google servers â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 13 â€” System Performance & Metrics Summary

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   System Performance Metrics (Measured Results)             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  End-to-End Latency Breakdown:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Stage                         â”‚ Avg. Latency â”‚ Notes        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  ESP32 sensor read             â”‚    < 10 ms   â”‚ GPIO/ADC     â”‚
  â”‚  JSON formatting (firmware)    â”‚    < 5  ms   â”‚ ArduinoJson  â”‚
  â”‚  WiFi transmission to broker   â”‚   10â€“50 ms   â”‚ 2.4 GHz      â”‚
  â”‚  MQTT broker routing           â”‚    < 10 ms   â”‚ Mosquitto    â”‚
  â”‚  Django receive + parse        â”‚   10â€“30 ms   â”‚ paho-mqtt    â”‚
  â”‚  Differential privacy (noise)  â”‚    < 5  ms   â”‚ numpy        â”‚
  â”‚  RSA encrypt/decrypt           â”‚   10â€“30 ms   â”‚ PyCryptodome â”‚
  â”‚  SQLite database write         â”‚   10â€“30 ms   â”‚ Django ORM   â”‚
  â”‚  Ollama LLM inference          â”‚  500â€“1000 ms â”‚ llama3.2:1b  â”‚
  â”‚  Alert creation (if anomaly)   â”‚    < 10 ms   â”‚ Django ORM   â”‚
  â”‚  Email dispatch (async)        â”‚  100â€“500 ms  â”‚ Gmail SMTP   â”‚
  â”‚  Dashboard API response        â”‚    < 100 ms  â”‚ Django view  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  TOTAL (sensor â†’ dashboard)    â”‚   ~ 1â€“3 sec  â”‚ end-to-end   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Throughput & Resource Utilization:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Metric                          â”‚ Value                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Sensor readings per device      â”‚ 6 sensors Ã— 1/2s = 3/sec  â”‚
  â”‚  MQTT messages per second        â”‚ ~3 messages/second         â”‚
  â”‚  Payload size per message        â”‚ ~250 bytes                 â”‚
  â”‚  Network bandwidth required      â”‚ < 1 Mbps per device        â”‚
  â”‚  Daily storage estimate          â”‚ ~50 MB per device/day      â”‚
  â”‚  ESP32 SRAM usage                â”‚ ~25% (WiFi + MQTT + DHT)   â”‚
  â”‚  Backend CPU usage (avg)         â”‚ ~12% (Django + Ollama)     â”‚
  â”‚  Backend RAM usage               â”‚ ~18% (database + cache)    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Privacy & Security Measurements:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Metric                          â”‚ Value                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Differential Privacy: Îµ         â”‚ 0.5 (configurable)        â”‚
  â”‚  Differential Privacy: Î´         â”‚ 1 Ã— 10â»âµ                  â”‚
  â”‚  Statistical accuracy loss       â”‚ < 2%                      â”‚
  â”‚  RSA key size                    â”‚ 2048 bits                 â”‚
  â”‚  Encryption padding              â”‚ OAEP                      â”‚
  â”‚  Hash algorithm                  â”‚ SHA-256                   â”‚
  â”‚  Authentication success rate     â”‚ 100%                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Anomaly Detection Results:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Metric                          â”‚ Value                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  Total sensor readings stored    â”‚ 1,000+                    â”‚
  â”‚  Total alerts generated          â”‚ 150+                      â”‚
  â”‚  Detection accuracy              â”‚ ~99%                      â”‚
  â”‚  False positive rate             â”‚ < 0.5%                    â”‚
  â”‚  System uptime                   â”‚ ~99%                      â”‚
  â”‚  AI model                        â”‚ llama3.2:1b (local)       â”‚
  â”‚  Average AI inference time       â”‚ 500â€“1000 ms               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Figure 14 â€” Proposed Future Architecture (Scalability Vision)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    IoTShield â€” Scalability & Future Vision                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Current Architecture (v1.0 â€” Single Site):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  1 Ã— ESP32  â”‚â”€â”€â”€â–ºâ”‚ Mosquitto (1) â”‚â”€â”€â”€â–ºâ”‚ Django (1)   â”‚â”€â”€â”€â–ºâ”‚ SQLite (1)   â”‚
  â”‚  6 Sensors  â”‚    â”‚               â”‚    â”‚ + Ollama LLM  â”‚    â”‚              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Proposed Future Architecture (v2.0 â€” Multi-Site, Cloud-Ready):

                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   Site A: Home 1       â”‚   Cloud / Edge Gateway   â”‚   Site B: Home 2
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                          â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ESP32 Ã— N   â”‚â”€â”€â”€â”€â–ºâ”‚  Load Balancer           â”‚â—„â”€â”€â”‚ ESP32 Ã— N   â”‚
   â”‚ Raspberry Piâ”‚     â”‚                          â”‚   â”‚ Raspberry Piâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚  â”‚ MQTT Cluster     â”‚  â”‚
   Site C: Office        â”‚  â”‚ (Mosquitto HA)   â”‚  â”‚   Site D: Lab
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ESP32 Ã— N   â”‚â”€â”€â”€â”€â–º â”‚                          â”‚â—„â”€â”€â”‚ ESP32 Ã— N   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚  â”‚ Django Cluster   â”‚  â”‚
                         â”‚  â”‚ (Multi-process)  â”‚  â”‚
                         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                         â”‚                          â”‚
                         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                         â”‚  â”‚ PostgreSQL        â”‚  â”‚
                         â”‚  â”‚ (Distributed DB)  â”‚  â”‚
                         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                         â”‚                          â”‚
                         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                         â”‚  â”‚ Advanced LLM     â”‚  â”‚
                         â”‚  â”‚ (llama3.2:7b or  â”‚  â”‚
                         â”‚  â”‚  llama3.3:70b)   â”‚  â”‚
                         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Planned Enhancements:
  âœ… Current     : SQLite â†’ Proposed: PostgreSQL cluster
  âœ… Current     : Single Ollama â†’ Proposed: Multi-GPU LLM inference
  âœ… Current     : Port 1883 (plain) â†’ Proposed: Port 8883 (MQTT-TLS)
  âœ… Current     : HTTP Port 8000 â†’ Proposed: HTTPS Port 443
  âœ… Current     : 1 ESP32 â†’ Proposed: 100+ devices per site
  âœ… Current     : Local only â†’ Proposed: AWS IoT / Azure IoT Hub
  âœ… Current     : Manual key mgmt â†’ Proposed: PKI Certificate Authority
```

---

*Document generated for the final thesis submission of the IoTShield project.*
*Authors: Anowar Hossain & Shihab Sarker â€” SMUCT CSE Department, Dhaka, Bangladesh.*
*Date: February 2026*
